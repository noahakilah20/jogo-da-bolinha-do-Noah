<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Jogo da Bolinha Colorida</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #222;
      font-family: Arial, sans-serif;
    }

    #gameCanvas {
      display: block;
      background-color: #111;
      margin: 0 auto;
    }

    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      color: #fff;
      font-size: 18px;
      z-index: 10;
    }

    #titulo {
      position: absolute;
      top: 10px;
      right: 10px;
      color: #fff;
      font-size: 20px;
      font-weight: bold;
      z-index: 10;
    }
  </style>
</head>
<body>

<canvas id="gameCanvas" width="400" height="600"></canvas>
<div id="info">
  Pontuação: <span id="score">0</span><br>
  Recorde: <span id="recorde">0</span>
</div>
<div id="titulo">Jogo da Bolinha</div>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  // Posição da barra
  const paddleWidth = 80;
  const paddleHeight = 10;
  let paddleX = (canvas.width - paddleWidth) / 2;

  // Pontuação
  let score = 0;
  let recorde = parseInt(localStorage.getItem("recorde")) || 0;
  document.getElementById("recorde").textContent = recorde;

  // Cores disponíveis
  const colors = ["#ff4444", "#44ff44", "#4444ff", "#ffff44", "#ff44ff"];

  // Bolinhas (pode haver várias)
  let balls = [{
    x: canvas.width / 2,
    y: canvas.height / 2,
    radius: 8,
    speedX: 3,
    speedY: -3,
    color: colors[Math.floor(Math.random() * colors.length)]
  }];

  // Tijolos
  const brickRowCount = 5;
  const brickColumnCount = 6;
  const brickWidth = 60;
  const brickHeight = 20;
  const brickPadding = 10;
  const brickOffsetTop = 40;
  const brickOffsetLeft = 20;

  let bricks = [];
  for (let c = 0; c < brickColumnCount; c++) {
    for (let r = 0; r < brickRowCount; r++) {
      const color = colors[Math.floor(Math.random() * colors.length)];
      bricks.push({
        x: c * (brickWidth + brickPadding) + brickOffsetLeft,
        y: r * (brickHeight + brickPadding) + brickOffsetTop,
        width: brickWidth,
        height: brickHeight,
        color: color,
        active: true
      });
    }
  }

  function drawBricks() {
    bricks.forEach(brick => {
      if (brick.active) {
        ctx.fillStyle = brick.color;
        ctx.fillRect(brick.x, brick.y, brick.width, brick.height);
      }
    });
  }

  function drawPaddle() {
    ctx.fillStyle = "#00bfff";
    ctx.fillRect(paddleX, canvas.height - paddleHeight - 10, paddleWidth, paddleHeight);
  }

  function drawBalls() {
    balls.forEach(ball => {
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
      ctx.fillStyle = ball.color;
      ctx.fill();
      ctx.closePath();
    });
  }

  function moveBalls() {
    balls.forEach((ball, index) => {
      ball.x += ball.speedX;
      ball.y += ball.speedY;

      // Rebater nas paredes
      if (ball.x + ball.radius > canvas.width || ball.x - ball.radius < 0) {
        ball.speedX *= -1;
      }
      if (ball.y - ball.radius < 0) {
        ball.speedY *= -1;
      }

      // Rebater na barra
      if (
        ball.y + ball.radius >= canvas.height - paddleHeight - 10 &&
        ball.x >= paddleX &&
        ball.x <= paddleX + paddleWidth
      ) {
        ball.speedY *= -1;
        score++;
        document.getElementById("score").textContent = score;

        if (score > recorde) {
          recorde = score;
          localStorage.setItem("recorde", recorde);
          document.getElementById("recorde").textContent = recorde;
        }
      }

      // Checa colisão com tijolos
      bricks.forEach(brick => {
        if (brick.active) {
          if (
            ball.x > brick.x &&
            ball.x < brick.x + brick.width &&
            ball.y > brick.y &&
            ball.y < brick.y + brick.height
          ) {
            ball.speedY *= -1;

            // Somente destrói tijolo se a cor for igual
            if (ball.color === brick.color) {
              brick.active = false;
              score += 5;
            }

            // Multiplica a bolinha (máximo de 10 para não travar o jogo)
            if (balls.length < 10) {
              balls.push({
                x: ball.x,
                y: ball.y,
                radius: 8,
                speedX: -ball.speedX,
                speedY: -ball.speedY,
                color: ball.color
              });
            }
          }
        }
      });

      // Fim de jogo se alguma bola sair por baixo
      if (ball.y - ball.radius > canvas.height) {
        balls.splice(index, 1);
        if (balls.length === 0) {
          alert(`Game Over!\nPontuação: ${score}\nRecorde: ${recorde}`);
          document.location.reload();
        }
      }
    });
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBricks();
    drawPaddle();
    drawBalls();
    moveBalls();
    requestAnimationFrame(draw);
  }

  // Movimento da barra com mouse
  document.addEventListener("mousemove", (e) => {
    const rect = canvas.getBoundingClientRect();
    paddleX = e.clientX - rect.left - paddleWidth / 2;
  });

  // Movimento da barra com toque (celular)
  document.addEventListener("touchmove", (e) => {
    const rect = canvas.getBoundingClientRect();
    paddleX = e.touches[0].clientX - rect.left - paddleWidth / 2;
  });

  // Impede que a barra saia da tela
  setInterval(() => {
    if (paddleX < 0) paddleX = 0;
    if (paddleX + paddleWidth > canvas.width) paddleX = canvas.width - paddleWidth;
  }, 10);

  draw();
</script>

</body>
</html>
